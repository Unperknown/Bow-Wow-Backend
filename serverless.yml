service: bow-wow-backend

plugins:
  - serverless-plugin-typescript
  - serverless-bundle
  - serverless-dotenv-plugin
  - serverless-appsync-plugin
  - serverless-appsync-offline

package:
  individually: true

provider:
  name: aws
  runtime: nodejs12.x
  stage: dev
  region: ${env:AWS_REGION}

custom:
  accountId: ${env:AWS_ACCOUNT_ID}
  appsync-offline:
    port: 62222
    dynamodb:
      client:
        endpoint: "http://localhost:8000"
        region: localhost
  appSync:
    name: bow-wow-app
    authenticationType: AMAZON_COGNITO_USER_POOLS
    schema: schema.graphql
    userPoolConfig:
      awsRegion: ${env:AWS_REGION}
      defaultAction: ALLOW
      userPoolId: ${env:AWS_USER_POOL_ID}
    dataSources:
      - type: AMAZON_DYNAMODB
        name: bw_datas
        description: 'Bow-Wow Datas'
        config:
          tableName: 'bow-wow'
          serviceRoleArn: ${env:DATASOURCE_SERVICE_ROLE_ARN}

functions:
  graphql:
    handler: handler.graphql
